<!DOCTYPE html>
<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <title>检测到更新的版本</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no" />
    <meta name="description" itemprop="description" content="更新页面" />
    <link rel="stylesheet" href="./css/mdui.min.css" />
    <script async src="./js/mdui.min.js"></script>
    <link rel="icon" href="./icons/Class-Circle.svg" />
    <meta property="og:description" content="更新页面" />
    <link rel="stylesheet" href="./css/all.css" />
  </head>

  <body class="mdui-bottom-nav-fixed">
    <!--应用栏-->
    <div class="mdui-appbar" style="-webkit-app-region: drag">
      <div class="mdui-toolbar mdui-color-transparent">
        <a class="mdui-typo-headline">新版本可用</a>
        <a id="version-name" class="mdui-typo-title">主页</a>
        <div class="mdui-toolbar-spacer"></div>
      </div>
    </div>
    <div class="mdui-container mdui-typo">
      <h5>以下是更新日志</h5>
      <p id="version-detail"></p>
      <button class="mdui-btn" onclick="window.close();">取消</button>
      <script>
        //获取最新版本信息
        var url = "https://cdn.zhangda.xyz/random-roll-call-system/update.json";
        var request = new XMLHttpRequest();
        request.open("get", url);
        request.send(null); 
        request.onload = function () {
          if (request.status == 200) {
            var update_detail = JSON.parse(request.responseText);
            for (var i = 0; i < update_detail.length; i++) {
            }
            //替换文本
            document.getElementById("version-name").innerHTML =
              update_detail.name;
            document.getElementById("version-detail").innerHTML =
              update_detail.detail;
            document
              .getElementById("url")
              .setAttribute(
                "onclick",
                (innerHTML =
                  'javascript:shell.openExternal("' +
                  update_detail.download_url +
                  '");')
              );
          } else {
          }
        };
        const { shell } = require("electron");
      </script>
      <a id="url" onclick=""><button class="mdui-btn">安装</button></a>
    </div>
  </body>
</html>
